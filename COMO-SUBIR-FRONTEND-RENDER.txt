================================================================================
  CÓMO SUBIR EL FRONTEND (Angular) A RENDER.COM
================================================================================

Requisitos previos
-----------------
- Cuenta en https://render.com
- Repositorio Git con el código del frontend (carpeta Front/front-comecyt o la raíz del front)
- URL del backend ya desplegado (ej. https://comecyt-api.onrender.com) para configurar la API


PASO 1: Configurar la URL del API para producción
--------------------------------------------------
El proyecto ya incluye:
  - src/environments/environment.production.ts (con apiBaseUrl para producción)
  - angular.json configurado para usar ese archivo en "production"

Solo debes editar environment.production.ts y poner la URL real de tu backend:

  apiBaseUrl: 'https://TU-BACKEND.onrender.com'

(Sustituye TU-BACKEND.onrender.com por la URL que te dé Render al crear el Web Service del backend.)


PASO 2: Crear Static Site en Render (Frontend)
----------------------------------------------
1. Entra a https://dashboard.render.com
2. Clic en "New +" → "Static Site".
3. Conecta tu repositorio (GitHub/GitLab).
4. Configuración:

   - Name: ej. comecyt-portal o front-comecyt
   - Branch: main (o la rama que uses)

   Root Directory (importante):
   - Si el front está en una subcarpeta (ej. Front/front-comecyt):
     Root Directory: Front/front-comecyt
   - Si el repo es solo el front: deja en blanco.

   Build Command:
     npm install
     npm run build

   (O si usas ci para builds más rápidos y reproducibles: npm ci && npm run build)

   Publish Directory:
     dist/comecyt-portal

   (En Angular 18 con angular.json por defecto, la salida suele ser dist/comecyt-portal.
    Si tu outputPath en angular.json es otro, usa esa ruta.)

   Environment variables (opcional para este flujo):
   - No necesarias si usaste environment.production.ts con la URL fija.
   - Si en el futuro usas API_BASE_URL para generar el env en build, añádela aquí.


PASO 3: Desplegar
-----------------
1. Clic en "Create Static Site".
2. Render instalará dependencias, ejecutará npm run build y publicará
   el contenido de dist/comecyt-portal.
3. La URL del frontend será algo como: https://comecyt-portal.onrender.com


PASO 4: Redirects / Rewrites (OBLIGATORIO para que no salga "Not Found" al recargar)
--------------------------------------------------------------------------------------
Angular es una SPA: las rutas (/login, /dashboard, etc.) no son archivos en el servidor.
Si no configuras esto, al actualizar la página (F5) o abrir una URL directa sale "Not Found".

1. En Render: Dashboard → tu Static Site (frontend) → pestaña "Redirects / Rewrites".
2. Add Rule (o "Añadir regla"):
   - Source (Origen):   /*
   - Destination (Destino):   /index.html
   - Action:   Rewrite (no Redirect)
3. Guarda. Con esto, cualquier ruta (salvo archivos que existan, como .js/.css) servirá
   index.html y Angular mostrará la vista correcta.

PASO 5: Probar
--------------
- Abre la URL del Static Site.
- Navega a login, dashboard, etc. Luego recarga (F5): ya no debe salir "Not Found".
- Prueba login, registro y que las llamadas al API vayan a la URL del backend.
- Revisa la consola del navegador (F12) por errores CORS o 404; si hay CORS,
  configura el backend para permitir el origen del front (ej. https://comecyt-front.onrender.com).


Errores frecuentes
------------------
- "Build failed" / "npm run build failed":
  - Revisa Root Directory.
  - Asegúrate de que existe environment.production.ts y fileReplacements en production.

- "Not Found" al actualizar la página o abrir una ruta directa (ej. /login, /dashboard):
  - Falta la regla de Rewrite. Ve a PASO 4 arriba: Redirects / Rewrites → Source: /*,
    Destination: /index.html, Action: Rewrite.

- Llamadas al API fallan o CORS:
  - Verifica apiBaseUrl en environment.production.ts (sin barra final).
  - El backend ya permite https://comecyt-front.onrender.com y https://comecyt-portal.onrender.com.
    Si tu Static Site tiene otra URL, añádela en CorsFilterExplicit y CorsConfig (allowedOrigins).
  - "CORS Missing Allow Origin" o 404 en OPTIONS (ej. /auth/login): suele ser que el backend
    en Render está dormido (plan free). La primera petición puede tardar 30–60 s en despertar;
    reintenta o espera y vuelve a cargar. El backend debe usar server.port=${PORT:8080} (variable
    PORT que Render asigna); no fijar un puerto fijo (ej. 8081) en producción.


Resumen de URLs
---------------
- Backend (Web Service): https://comecyt-api.onrender.com
- Frontend (Static Site): https://comecyt-portal.onrender.com
- En environment.production.ts: apiBaseUrl = URL del backend.

================================================================================
