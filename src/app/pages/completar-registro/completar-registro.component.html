<div class="app-body" [formGroup]="form">

  <aside class="sidebar">
    <!-- Indicador de Progreso General -->
    <div class="progress-card">
      <div class="progress-header">
        <h4 class="progress-title">Progreso del Registro</h4>
        <span class="progress-percentage">{{ getOverallProgress() }}%</span>
      </div>
      <div class="progress-bar-container">
        <div class="progress-bar" [style.width.%]="getOverallProgress()"></div>
      </div>
      <p class="progress-text">Completa todas las secciones para finalizar tu registro</p>
    </div>

    <nav aria-label="Navegación lateral" class="nav-steps">
      <!-- Secciones dinámicas con progreso -->
      <ng-container *ngFor="let step of getSectionSteps()">
        <div class="nav-group" *ngIf="step.order === 1 || getSectionSteps()[step.order - 2]?.group !== step.group">
          <div class="group-label">{{ step.group }}</div>
        </div>
        
        <button type="button" class="nav-step-item"
          (click)="setView(step.id)"
          [class.active]="view() === step.id"
          [class.completed]="isSectionComplete(step.id)"
          [attr.aria-current]="view() === step.id ? 'page' : null">
          <div class="step-icon" [class.completed]="isSectionComplete(step.id)">
            <img [src]="step.iconImage" [alt]="step.title" style="width: 24px; height: 24px; object-fit: contain;">
            <i class="fas fa-check check-icon" *ngIf="isSectionComplete(step.id)"></i>
          </div>
          <div class="step-content">
            <span class="step-title">{{ step.title }}</span>
            <span class="step-subtitle">{{ step.description }}</span>
            <div class="step-progress">
              <div class="step-progress-bar" [style.--progress-width.%]="getSectionProgress(step.id)">
                <div class="step-progress-fill" [style.width.%]="getSectionProgress(step.id)"></div>
              </div>
              <span class="step-progress-text">
                <img [src]="step.iconImage" [alt]="step.title" style="width: 12px; height: 12px; object-fit: contain; margin-right: 4px; vertical-align: middle;">
                {{ getSectionProgress(step.id) }}%
              </span>
            </div>
          </div>
        </button>
      </ng-container>

      <!-- Botón Migración SECIHTI al final -->
      <div class="nav-group" style="margin-top: 24px;">
        <div class="group-label">Migración</div>
      </div>
      <button type="button" class="nav-step-item"
        (click)="setView('documentos')"
        [class.active]="view() === 'documentos'"
        [attr.aria-current]="view() === 'documentos' ? 'page' : null">
        <div class="step-icon">
          <img src="assets/img/documentos.png" alt="Migración SECIHTI" style="width: 24px; height: 24px; object-fit: contain;">
        </div>
        <div class="step-content">
          <span class="step-title">Migración SECIHTI</span>
          <span class="step-subtitle">Importar datos históricos del sistema anterior</span>
          <div class="step-info" style="font-size: 11px; color: #666; margin-top: 4px; line-height: 1.3;">
            Incluye: Trayectorias, producción científica, logros, idiomas, estancias y divulgación
          </div>
        </div>
      </button>
    </nav>
  </aside>

  <main class="content">
    <ng-container [ngSwitch]="view()">



<section *ngSwitchCase="'personaPrincipal'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/user.png" alt="Datos Personales" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Datos Personales</h1>
        <p class="section-subtitle">Completa tu información personal básica</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('personaPrincipal') }}%</span>
      </div>
    </div>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona shadow-sm mb-3">
            <div class="card-header bg-light text-borgona fw-bold text-center">Identificación</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/id-insignia.png" alt="ID" style="width: 50px; opacity: 0.7;">
              </div>
              <div class="text-start">
                <label class="form-label small text-muted fw-bold">ID Interno</label>
                <input type="text" id="id_perfil" formControlName="uuid_interno" 
                       class="form-control form-control-sm text-center" readonly>
                       <p class="text-muted small">Formato SIIMEX-XXX-INV (investigador/a) o SIIMEX-XXX-IND (innovador/a). Este ID es único y se utiliza para identificar tu perfil en el sistema.</p>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold text-center">Enlaces Académicos</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="orcid_url">ORCID URL</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/copiar-link.png" style="width:16px;height:16px;">
                  </span>
                  <input type="url" id="orcid_url" formControlName="pers_orcid_url" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_orcid_url')"
                         placeholder="https://orcid.org/...">
                  <div class="invalid-feedback">Ingrese una URL válida (http/https).</div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold" for="scholar_url">Google Scholar URL</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/copiar-link.png" style="width:16px;height:16px;">
                  </span>
                  <input type="url" id="scholar_url" formControlName="pers_scholar_url" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_scholar_url')"
                         placeholder="https://scholar.google.com/...">
                  <div class="invalid-feedback">Ingrese una URL válida (http/https).</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Datos de Identidad</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="nombre">Nombre(s) *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/user.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="nombre" formControlName="pers_nombre" 
                           class="form-control input-custom" 
                           [class.is-invalid]="isFieldInvalid('pers_nombre')"
                           placeholder="Nombre(s)">
                    <div class="invalid-feedback">El nombre es obligatorio.</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="primer_apellido">Primer Apellido *</label>
                  <input type="text" id="primer_apellido" formControlName="pers_primer_apellido" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_primer_apellido')"
                         placeholder="Apellido Paterno">
                  <div class="invalid-feedback">El primer apellido es obligatorio.</div>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="segundo_apellido">Segundo Apellido</label>
                  <input type="text" id="segundo_apellido" formControlName="pers_segundo_apellido" 
                         class="form-control input-custom" placeholder="Apellido Materno">
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información Oficial y Demográfica</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="curp">CURP *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/archivo.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="curp" formControlName="pers_curp" 
                           class="form-control input-custom text-uppercase" 
                           [class.is-invalid]="isFieldInvalid('pers_curp')"
                           placeholder="CURP">
                    <div class="invalid-feedback">Formato de CURP inválido (18 caracteres).</div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="rfc">RFC *</label>
                  <input type="text" id="rfc" formControlName="pers_rfc" 
                         class="form-control input-custom text-uppercase" 
                         [class.is-invalid]="isFieldInvalid('pers_rfc')"
                         placeholder="RFC">
                  <div class="invalid-feedback">RFC obligatorio (Mínimo 10 caracteres).</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="fecha_nacimiento">Fecha de Nacimiento *</label>
                  <input type="date" id="fecha_nacimiento" formControlName="pers_fecha_nacimiento" 
                         class="form-control input-custom"
                         [class.is-invalid]="isFieldInvalid('pers_fecha_nacimiento')">
                  <div class="invalid-feedback">La fecha de nacimiento es obligatoria.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="sexo_nombre">Sexo</label>
                  <select id="sexo_nombre" formControlName="pers_sexo_nombre" class="form-select input-custom">
                    <option value="">Selecciona...</option>
                    <option value="Mujer">Mujer</option>
                    <option value="Hombre">Hombre</option>
                    <option value="Otro">Otro</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Lugar de Nacimiento y Estado Civil</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="pais_nacimiento_nombre">País de Nacimiento</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/paises.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="pais_nacimiento_nombre" formControlName="pers_pais_nac_nombre" 
                           class="form-control input-custom" placeholder="País">
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="entidad_nombre">Entidad Federativa *</label>
                  <select id="entidad_nombre" formControlName="pers_entidad_nombre" 
                          class="form-select input-custom"
                          [class.is-invalid]="isFieldInvalid('pers_entidad_nombre')">
                    <option value="">Selecciona entidad...</option>
                    <option *ngFor="let entidad of entidadesFederativas" [value]="entidad">
                      {{ entidad }}
                    </option>
                  </select>
                  <div class="invalid-feedback">La entidad federativa es obligatoria.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="nacionalidad_nombre">Nacionalidad</label>
                  <input type="text" id="nacionalidad_nombre" formControlName="pers_nacionalidad_nombre" 
                         class="form-control input-custom" placeholder="Ej. Mexicana">
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="estado_civil_nombre">Estado Civil</label>
                  <select id="estado_civil_nombre" formControlName="pers_estado_civil_nombre" class="form-select input-custom">
                    <option value="">Selecciona...</option>
                    <option value="Soltero(a)">Soltero(a)</option>
                    <option value="Casado(a)">Casado(a)</option>
                    <option value="Divorciado(a)">Divorciado(a)</option>
                    <option value="Viudo(a)">Viudo(a)</option>
                    <option value="Unión Libre">Unión Libre</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Semblanza Profesional</div>
            <div class="card-body">
              <label class="form-label fw-bold small" for="semblanza">Resumen de trayectoria *</label>
              <textarea id="semblanza" formControlName="pers_semblanza" class="form-control input-custom" 
                        [class.is-invalid]="isFieldInvalid('pers_semblanza')"
                        rows="5" placeholder="Escribe tu semblanza aquí..."></textarea>
              <div class="invalid-feedback">La semblanza es obligatoria.</div>
            </div>
          </div>

          <div class="text-center mt-4">
            <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto" 
                    (click)="setView('institucion')">
              <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
              Siguiente: Institución
            </button>
          </div>
        </div>   
      </div>
  </div>
</section>

<!-- Caso 'inicio' ahora muestra Datos Personales (mismo contenido que personaPrincipal) -->
<section *ngSwitchCase="'inicio'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/user.png" alt="Datos Personales" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Datos Personales</h1>
        <p class="section-subtitle">Completa tu información personal básica</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('personaPrincipal') }}%</span>
      </div>
    </div>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona shadow-sm mb-3">
            <div class="card-header bg-light text-borgona fw-bold text-center">Identificación</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/id-insignia.png" alt="ID" style="width: 50px; opacity: 0.7;">
              </div>
              <div class="text-start">
                <label class="form-label small text-muted fw-bold">ID Interno</label>
                <input type="text" id="id_perfil_inicio" formControlName="uuid_interno" 
                       class="form-control form-control-sm text-center" readonly>
                       <p class="text-muted small">Formato SIIMEX-XXX-INV (investigador/a) o SIIMEX-XXX-IND (innovador/a). Este ID es único y se utiliza para identificar tu perfil en el sistema.</p>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold text-center">Enlaces Académicos</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="orcid_url_inicio">ORCID URL (Opcional)</label>
                <p class="text-muted small">Identificador Abierto de Investigadora, Investigador, Colaboradora y Colaborador.</p>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/copiar-link.png" style="width:16px;height:16px;">
                  </span>
                  <input type="url" id="orcid_url_inicio" formControlName="pers_orcid_url" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_orcid_url')"
                         placeholder="https://orcid.org/...">
                  <div class="invalid-feedback">Ingrese una URL válida (http/https).</div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold" for="scholar_url_inicio">Google Scholar URL (Opcional)</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/copiar-link.png" style="width:16px;height:16px;">
                  </span>
                  <input type="url" id="scholar_url_inicio" formControlName="pers_scholar_url" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_scholar_url')"
                         placeholder="https://scholar.google.com/...">
                  <div class="invalid-feedback">Ingrese una URL válida (http/https).</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Datos de Identidad</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="nombre_inicio">Nombre(s) *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/user.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="nombre_inicio" formControlName="pers_nombre" 
                           class="form-control input-custom" 
                           [class.is-invalid]="isFieldInvalid('pers_nombre')"
                           placeholder="Nombre(s)">
                    <div class="invalid-feedback">El nombre es obligatorio.</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="primer_apellido_inicio">Primer Apellido *</label>
                  <input type="text" id="primer_apellido_inicio" formControlName="pers_primer_apellido" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('pers_primer_apellido')"
                         placeholder="Apellido Paterno">
                  <div class="invalid-feedback">El primer apellido es obligatorio.</div>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-bold small" for="segundo_apellido_inicio">Segundo Apellido</label>
                  <input type="text" id="segundo_apellido_inicio" formControlName="pers_segundo_apellido" 
                         class="form-control input-custom" placeholder="Apellido Materno">
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información Oficial y Demográfica</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="curp_inicio">CURP *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/archivo.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="curp_inicio" formControlName="pers_curp" 
                           class="form-control input-custom text-uppercase" 
                           [class.is-invalid]="isFieldInvalid('pers_curp')"
                           placeholder="CURP">
                    <div class="invalid-feedback">Formato de CURP inválido (18 caracteres).</div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="rfc_inicio">RFC *</label>
                  <input type="text" id="rfc_inicio" formControlName="pers_rfc" 
                         class="form-control input-custom text-uppercase" 
                         [class.is-invalid]="isFieldInvalid('pers_rfc')"
                         placeholder="RFC">
                  <div class="invalid-feedback">RFC obligatorio (Mínimo 10 caracteres).</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="fecha_nacimiento_inicio">Fecha de Nacimiento *</label>
                  <input type="date" id="fecha_nacimiento_inicio" formControlName="pers_fecha_nacimiento" 
                         class="form-control input-custom"
                         [class.is-invalid]="isFieldInvalid('pers_fecha_nacimiento')">
                  <div class="invalid-feedback">La fecha de nacimiento es obligatoria.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="sexo_nombre_inicio">Sexo</label>
                  <select id="sexo_nombre_inicio" formControlName="pers_sexo_nombre" class="form-select input-custom">
                    <option value="">Selecciona...</option>
                    <option value="Mujer">Mujer</option>
                    <option value="Hombre">Hombre</option>
                    <option value="Otro">Otro</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Lugar de Nacimiento y Estado Civil</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="pais_nacimiento_nombre_inicio">País de Nacimiento</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/paises.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="pais_nacimiento_nombre_inicio" formControlName="pers_pais_nac_nombre" 
                           class="form-control input-custom" placeholder="País">
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="entidad_nombre_inicio">Entidad Federativa *</label>
                  <select id="entidad_nombre_inicio" formControlName="pers_entidad_nombre" 
                          class="form-select input-custom"
                          [class.is-invalid]="isFieldInvalid('pers_entidad_nombre')">
                    <option value="">Selecciona entidad...</option>
                    <option *ngFor="let entidad of entidadesFederativas" [value]="entidad">
                      {{ entidad }}
                    </option>
                  </select>
                  <div class="invalid-feedback">La entidad federativa es obligatoria.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="nacionalidad_nombre_inicio">Nacionalidad</label>
                  <input type="text" id="nacionalidad_nombre_inicio" formControlName="pers_nacionalidad_nombre" 
                         class="form-control input-custom" placeholder="Ej. Mexicana">
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="estado_civil_nombre_inicio">Estado Civil</label>
                  <select id="estado_civil_nombre_inicio" formControlName="pers_estado_civil_nombre" class="form-select input-custom">
                    <option value="">Selecciona...</option>
                    <option value="Soltero(a)">Soltero(a)</option>
                    <option value="Casado(a)">Casado(a)</option>
                    <option value="Divorciado(a)">Divorciado(a)</option>
                    <option value="Viudo(a)">Viudo(a)</option>
                    <option value="Unión Libre">Unión Libre</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Semblanza Profesional</div>
            <div class="card-body">
              <label class="form-label fw-bold small" for="semblanza_inicio">Resumen de trayectoria *</label>
              <textarea id="semblanza_inicio" formControlName="pers_semblanza" class="form-control input-custom" 
                        [class.is-invalid]="isFieldInvalid('pers_semblanza')"
                        rows="5" placeholder="Escribe tu semblanza aquí..."></textarea>
              <div class="invalid-feedback">La semblanza es obligatoria.</div>
            </div>
          </div>

          <div class="text-center mt-4">
            <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto" 
                    (click)="setView('institucion')">
              <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
              Siguiente: Institución
            </button>
          </div>
        </div>   
      </div>
  </div>
</section>



<section *ngSwitchCase="'institucion'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/teacher_icon_243839.png" alt="Institución" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Institución</h1>
        <p class="section-subtitle">Información de la institución donde laboras</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('institucion') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Información de la Institución</h2>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Identificación Oficial</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/organizacion.png" alt="Institución" style="width: 64px;">
              </div>
              <div class="text-start">
                <label class="form-label fw-bold small" for="inst_clave_oficial">Código de Registro de la Institución *</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/archivo.png" style="width:16px;">
                  </span>
                  <input type="text" id="inst_clave_oficial" formControlName="inst_clave_oficial" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('inst_clave_oficial')"
                         placeholder="Ej. 4220000">
                  <div class="invalid-feedback">La clave debe ser numérica.</div>
                </div>
                <small class="form-text text-muted mt-1 d-block">Código único asignado por las autoridades educativas para identificar oficialmente a la institución.</small>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Clasificación</div>
            <div class="card-body">
              <label class="form-label small fw-bold" for="inst_tipo_id">Tipo de Institución *</label>
              <select id="inst_tipo_id" formControlName="inst_tipo_id" 
                      class="form-select input-custom"
                      [class.is-invalid]="isFieldInvalid('inst_tipo_id')">
                <option value="">Selecciona el tipo...</option>
                <option value="NAC">Institución Nacional (México)</option>
                <option value="EXT">Institución Extranjera (Internacional)</option>
              </select>
              <div class="invalid-feedback">Seleccione el tipo de institución.</div>
              <div class="form-text muted-small mt-2">
                <i class="fas fa-info-circle text-primary me-1"></i>
                Selecciona <strong>Nacional</strong> si la institución está ubicada en México, o <strong>Extranjera</strong> si está en otro país.
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Datos Generales y Ubicación</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="inst_nombre">Nombre de la Institución *</label>
                  <input type="text" id="inst_nombre" formControlName="inst_nombre" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('inst_nombre')"
                         placeholder="Nombre completo de la institución">
                  <div class="invalid-feedback">El nombre de la institución es obligatorio.</div>
                </div>
                
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="inst_pais_nombre">País donde se ubica la Institución *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/paises.png" style="width:18px;">
                    </span>
                    <select id="inst_pais_nombre" formControlName="inst_pais_nombre" 
                            class="form-select input-custom"
                            [class.is-invalid]="isFieldInvalid('inst_pais_nombre')">
                      <option value="">Selecciona el país...</option>
                      <option value="México">México</option>
                      <option value="Estados Unidos">Estados Unidos</option>
                    </select>
                    <div class="invalid-feedback">Seleccione un país.</div>
                  </div>
                </div>

                <!-- Entidad Federativa - Solo para México -->
                <div class="col-md-6" *ngIf="f['inst_pais_nombre'].value === 'México'">
                  <label class="form-label fw-bold small" for="inst_entidad_nombre">Estado o Entidad Federativa *</label>
                  <select id="inst_entidad_nombre" formControlName="inst_entidad_nombre" 
                          class="form-select input-custom"
                          [class.is-invalid]="isFieldInvalid('inst_entidad_nombre')">
                    <option value="">Selecciona el estado...</option>
                    <option *ngFor="let entidad of entidadesFederativas" [value]="entidad">{{ entidad }}</option>
                  </select>
                  <div class="invalid-feedback">Seleccione el estado o entidad federativa.</div>
                  <small class="form-text text-muted mt-1 d-block">Selecciona el estado de la República Mexicana donde se ubica la institución.</small>
                </div>

                <!-- Estado de EUA - Solo para Estados Unidos -->
                <div class="col-md-6" *ngIf="f['inst_pais_nombre'].value === 'Estados Unidos'">
                  <label class="form-label fw-bold small" for="inst_estado_usa">Estado *</label>
                  <select id="inst_estado_usa" formControlName="inst_estado_usa" 
                          class="form-select input-custom"
                          [class.is-invalid]="isFieldInvalid('inst_estado_usa')">
                    <option value="">Selecciona el estado...</option>
                    <option *ngFor="let estado of estadosEstadosUnidos" [value]="estado">{{ estado }}</option>
                  </select>
                  <div class="invalid-feedback">Seleccione el estado.</div>
                  <small class="form-text text-muted mt-1 d-block">Selecciona el estado de Estados Unidos donde se ubica la institución.</small>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Unidad Académica o Departamento</div>
            <div class="card-body">
              <p class="text-muted small mb-3">
                <i class="fas fa-info-circle text-primary me-1"></i>
                Especifica la unidad académica o departamento donde te encuentras adscrito dentro de la institución.
              </p>
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="inst_nivel_uno_nombre">Primer Nivel Organizacional</label>
                  <input type="text" id="inst_nivel_uno_nombre" formControlName="inst_nivel_uno_nombre" 
                         class="form-control input-custom" 
                         placeholder="Ej. Facultad de Ciencias, Dirección General, Instituto de Investigación">
                  <small class="form-text text-muted mt-1 d-block">
                    Nivel superior de organización: Facultad, Instituto, Dirección, Centro, etc.
                  </small>
                </div>

                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="inst_nivel_dos_nombre">Segundo Nivel Organizacional (Opcional)</label>
                  <input type="text" id="inst_nivel_dos_nombre" formControlName="inst_nivel_dos_nombre" 
                         class="form-control input-custom" 
                         placeholder="Ej. Departamento de Matemáticas, División de Estudios, Carrera de Ingeniería">
                  <small class="form-text text-muted mt-1 d-block">
                    Nivel específico: Departamento, División, Programa, Carrera, Área, etc.
                  </small>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('area-conocimiento')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Área de conocimiento
        </button>
      </div>

    </div>
  </div>
</section>

   <section *ngSwitchCase="'area-conocimiento'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img [src]="getSectionIconImage('area-conocimiento')" alt="Área de Conocimiento" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Área de Conocimiento</h1>
        <p class="section-subtitle">Define tu especialidad académica y profesional mediante una clasificación jerárquica</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('area-conocimiento') }}%</span>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-4 mb-4">
        <div class="card border-borgona mb-3 shadow-sm">
          <div class="card-header bg-light text-borgona fw-bold">
            <i class="fas fa-info-circle me-2"></i>
            Información General
          </div>
          <div class="card-body text-center">
            <div class="mb-3">
              <img src="assets/img/id-insignia.png" alt="Área" style="width: 64px; opacity: 0.8;">
            </div>
            <p class="text-muted small mb-3">
              <i class="fas fa-lightbulb text-warning me-1"></i>
              Clasifica tu perfil académico y profesional mediante un sistema jerárquico que va de lo general (Área) a lo específico (Subdisciplina).
            </p>
            <hr class="border-borgona opacity-25">
            
            <label class="form-label fw-bold text-borgona" for="area_version">
              <i class="fas fa-calendar-alt me-1"></i>
              Año del Catálogo SECIHTI
            </label>
            <input type="text" id="area_version" formControlName="area_version" 
                   class="form-control input-custom text-center" 
                   [class.is-invalid]="isFieldInvalid('area_version')"
                   placeholder="Ej. 2024">
            <div class="invalid-feedback">Ingrese un año válido (4 dígitos).</div>
            <small class="form-text text-muted mt-1 d-block">
              Versión del catálogo de Áreas de conocimiento que estás utilizando.
            </small>
          </div>
        </div>

        <div class="card border-borgona shadow-sm">
          <div class="card-body">
            <label class="form-label small text-muted">
              <i class="fas fa-link me-1"></i>
              ID de Perfil Vinculado
            </label>
          </div>
        </div>
      </div>

      <div class="col-lg-8">
        <div class="alert alert-info d-flex align-items-start mb-4">
          <i class="fas fa-info-circle me-2 mt-1"></i>
          <div>
            <strong>¿Cómo funciona la clasificación?</strong><br>
            La clasificación es jerárquica: <strong>Área Principal</strong> (obligatorio) → <strong>Campo</strong> (opcional) → <strong>Disciplina</strong> (opcional) → <strong>Subdisciplina</strong> (opcional). 
            Comienza con el nivel más amplio y especifica según sea necesario.
          </div>
        </div>
        
        <div class="card border-borgona mb-5 shadow-sm">
          <div class="card-header bg-light text-borgona fw-bold d-flex align-items-center justify-content-between py-4">
            <span class="d-flex align-items-center gap-2">
              <i class="fas fa-layer-group"></i>
              <span>1. Área Principal *</span>
            </span>
            <div class="d-flex align-items-center gap-2">
              <button type="button" class="btn btn-sm btn-link text-borgona p-0" 
                      (click)="mostrarAyuda('area')" 
                      title="Información sobre el Área Principal">
                <img src="assets/img/boton-de-informacion.png" alt="Información" style="width: 18px; height: 18px;">
              </button>
              <span class="badge bg-secondary opacity-50">ID: {{ f['area_id'].value || 'N/A' }}</span>
            </div>
          </div>
          <div class="card-body row g-3">
            <div class="col-md-8">
              <label class="form-label small fw-bold">
                <i class="fas fa-tag me-1"></i>
                Nombre del Área de Conocimiento
              </label>
              <input type="text" id="area_nombre" formControlName="area_nombre" 
                     class="form-control input-custom" 
                     [class.is-invalid]="isFieldInvalid('area_nombre')"
                     placeholder="Ej. Ciencias Físico-Matemáticas y de las Ingenierías">
              <div class="invalid-feedback">El nombre del Área es obligatorio.</div>
            </div>
            <div class="col-md-4">
              <label class="form-label small fw-bold">
                <i class="fas fa-key me-1"></i>
                Código del Área
              </label>
              <input type="text" id="area_clave" formControlName="area_clave" 
                     class="form-control input-custom" 
                     [class.is-invalid]="isFieldInvalid('area_clave')"
                     placeholder="Ej. 1">
              <div class="invalid-feedback">La clave es obligatoria.</div>
            </div>
            <input type="hidden" formControlName="area_id">
          </div>
        </div>

        <div class="card border-borgona mb-5 shadow-sm">
          <div class="card-header bg-light text-borgona fw-bold d-flex align-items-center justify-content-between py-4">
            <span class="d-flex align-items-center gap-2">
              <i class="fas fa-sitemap"></i>
              <span>2. Campo (Opcional)</span>
            </span>
            <div class="d-flex align-items-center gap-2">
              <button type="button" class="btn btn-sm btn-link text-borgona p-0" 
                      (click)="mostrarAyuda('campo')" 
                      title="Información sobre el Campo">
                <img src="assets/img/boton-de-informacion.png" alt="Información" style="width: 18px; height: 18px;">
              </button>
              <span class="badge bg-secondary opacity-50">ID: {{ f['campo_id'].value || 'N/A' }}</span>
            </div>
          </div>
          <div class="card-body row g-3">
            <div class="col-md-8">
              <label class="form-label small fw-bold">
                <i class="fas fa-tag me-1"></i>
                Nombre del Campo de Estudio
              </label>
              <input type="text" id="campo_nombre" formControlName="campo_nombre" class="form-control input-custom" 
                     placeholder="Ej. Ciencias de la Computación, Informática">
            </div>
            <div class="col-md-4">
              <label class="form-label small fw-bold">
                <i class="fas fa-key me-1"></i>
                Código del Campo
              </label>
              <input type="text" id="campo_clave" formControlName="campo_clave" class="form-control input-custom" placeholder="Ej. 1.1">
            </div>
            <input type="hidden" formControlName="campo_id">
          </div>
        </div>

        <div class="card border-borgona mb-5 shadow-sm">
          <div class="card-header bg-light text-borgona fw-bold d-flex align-items-center justify-content-between py-4">
            <span class="d-flex align-items-center gap-2">
              <i class="fas fa-microscope"></i>
              <span>3. Disciplina (Opcional)</span>
            </span>
            <div class="d-flex align-items-center gap-2">
              <button type="button" class="btn btn-sm btn-link text-borgona p-0" 
                      (click)="mostrarAyuda('disciplina')" 
                      title="Información sobre la Disciplina">
                <img src="assets/img/boton-de-informacion.png" alt="Información" style="width: 18px; height: 18px;">
              </button>
              <span class="badge bg-secondary opacity-50">ID: {{ f['disciplina_id'].value || 'N/A' }}</span>
            </div>
          </div>
          <div class="card-body row g-3">
            <div class="col-md-8">
              <label class="form-label small fw-bold">
                <i class="fas fa-tag me-1"></i>
                Nombre de la Disciplina
              </label>
              <input type="text" id="disciplina_nombre" formControlName="disciplina_nombre" class="form-control input-custom" 
                     placeholder="Ej. Inteligencia Artificial, Sistemas Distribuidos">
            </div>
            <div class="col-md-4">
              <label class="form-label small fw-bold">
                <i class="fas fa-key me-1"></i>
                Código de la Disciplina
              </label>
              <input type="text" id="disciplina_clave" formControlName="disciplina_clave" class="form-control input-custom" placeholder="Ej. 1.1.1">
            </div>
            <input type="hidden" formControlName="disciplina_id">
          </div>
        </div>

        <div class="card border-borgona mb-5 shadow-sm">
          <div class="card-header bg-light text-borgona fw-bold d-flex align-items-center justify-content-between py-4">
            <span class="d-flex align-items-center gap-2">
              <i class="fas fa-atom"></i>
              <span>4. Subdisciplina (Opcional)</span>
            </span>
            <div class="d-flex align-items-center gap-2">
              <button type="button" class="btn btn-sm btn-link text-borgona p-0" 
                      (click)="mostrarAyuda('subdisciplina')" 
                      title="Información sobre la Subdisciplina">
                <img src="assets/img/boton-de-informacion.png" alt="Información" style="width: 18px; height: 18px;">
              </button>
              <span class="badge bg-secondary opacity-50">ID: {{ f['subdisciplina_id'].value || 'N/A' }}</span>
            </div>
          </div>
          <div class="card-body row g-3">
            <div class="col-md-8">
              <label class="form-label small fw-bold">
                <i class="fas fa-tag me-1"></i>
                Nombre de la Subdisciplina
              </label>
              <input type="text" id="subdisciplina_nombre" formControlName="subdisciplina_nombre" class="form-control input-custom" 
                     placeholder="Ej. Procesamiento de Lenguaje Natural, Aprendizaje Automático">
            </div>
            <div class="col-md-4">
              <label class="form-label small fw-bold">
                <i class="fas fa-key me-1"></i>
                Código de la Subdisciplina
              </label>
              <input type="text" id="subdisciplina_clave" formControlName="subdisciplina_clave" class="form-control input-custom" placeholder="Ej. 1.1.1.1">
            </div>
            <input type="hidden" formControlName="subdisciplina_id">
          </div>
        </div>

      </div>
    </div>

    <div class="text-center mt-4">
      <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto" 
              (click)="setView('trayectoria-academica')">
        <i class="fas fa-arrow-right"></i>
        Siguiente: Perfil Académico
      </button>
    </div>
  </div>
</section>

<section *ngSwitchCase="'trayectoria-academica'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/creative-education.png" alt="Perfil Académico" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Perfil Académico</h1>
        <p class="section-subtitle">Grados académicos y estudios realizados</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('trayectoria-academica') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Trayectoria Académica</h2>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Estatus Académico</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="acad_nivel_nombre">Nivel de Escolaridad *</label>
                <select id="acad_nivel_nombre" formControlName="acad_nivel_nombre" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('acad_nivel_nombre')">
                  <option value="">Selecciona nivel...</option>
                  <option value="Doctorado">Doctorado</option>
                  <option value="Maestría">Maestría</option>
                  <option value="Licenciatura">Licenciatura</option>
                  <option value="Especialidad">Especialidad</option>
                </select>
                <div class="invalid-feedback">Seleccione un nivel académico.</div>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold" for="acad_estatus_nombre">Estatus de Finalización *</label>
                <select id="acad_estatus_nombre" formControlName="acad_estatus_nombre" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('acad_estatus_nombre')">
                  <option value="">Selecciona estatus...</option>
                  <option value="Titulado">Titulado</option>
                  <option value="Pasante">Pasante</option>
                  <option value="En curso">En curso</option>
                  <option value="En trámite">En trámite</option>
                  <option value="Candidato">Candidato</option>
                </select>
                <div class="invalid-feedback">Seleccione el estatus actual.</div>
              </div>
              <div class="mb-0" *ngIf="f['acad_estatus_nombre'].value !== 'En curso' && f['acad_estatus_nombre'].value !== 'En trámite'">
                <label class="form-label small fw-bold" for="acad_fecha_obtencion">Fecha de Obtención</label>
                <input type="date" id="acad_fecha_obtencion" formControlName="acad_fecha_obtencion" class="form-control input-custom">
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Documento Probatorio</div>
            <div class="card-body text-center">
              <div class="curriculum-placeholder mb-3" aria-hidden="true" style="border: 2px dashed #80002022; padding: 20px;">
                <img src="assets/img/documentos.png" alt="PDF" style="width: 40px;" class="mb-2">
                <br><span class="text-muted small">Título,Cedula o Acta de Examen</span>
              </div>
              <input type="file" class="form-control form-control-sm" 
                     (change)="onFileChange($event, 'cert1')" accept=".pdf">
              <div *ngIf="f['cert1'].value" class="text-success small mt-1">
                <i class="fas fa-check-circle"></i> Archivo listo
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información del Grado</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="acad_titulo">Título Obtenido *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/certificado.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="acad_titulo" formControlName="acad_titulo" 
                           class="form-control input-custom" 
                           [class.is-invalid]="isFieldInvalid('acad_titulo')"
                           placeholder="Ej. Doctorado en Ciencias de la Computación">
                    <div class="invalid-feedback">El nombre del título es obligatorio.</div>
                  </div>
                </div>

                <div class="col-md-8">
                  <label class="form-label fw-bold small">Institución de Egreso</label>
                  <input type="text" formControlName="inst_nombre" class="form-control input-custom" 
                         placeholder="Nombre de la universidad">
                </div>
                
                <div class="col-md-4">
  <label class="form-label fw-bold small" for="acad_cedula_profesional">Cédula Profesional *</label>
  <input type="text" id="acad_cedula_profesional" formControlName="acad_cedula_profesional" 
         class="form-control input-custom" 
         [class.is-invalid]="isFieldInvalid('acad_cedula_profesional')"
         placeholder="No. de Cédula">
  <div class="invalid-feedback">La cédula es obligatoria.</div>
</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información de Titulación</div>
            <div class="card-body row g-3">
              <div class="col-md-6">
                <label class="form-label fw-bold small" for="acad_opcion_titulacion">Opción de Titulación</label>
                <select id="acad_opcion_titulacion" formControlName="acad_opcion_titulacion" class="form-select input-custom">
                  <option value="">Selecciona opción...</option>
                  <option value="Tesis">Tesis</option>
                  <option value="Examen Global">Examen Global</option>
                  <option value="Experiencia Profesional">Experiencia Profesional</option>
                  <option value="Promedio">Excelencia Académica / Promedio</option>
                </select>
              </div>
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="acad_titulo_tesis">Título de la Tesis o Proyecto</label>
                <textarea id="acad_titulo_tesis" formControlName="acad_titulo_tesis" 
                          class="form-control input-custom" rows="3" 
                          placeholder="Nombre completo del trabajo de investigación"></textarea>
              </div>
            </div>
          </div>

          <div class="text-end">
          </div>

        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('trayectoria-profesional')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Trayectoria Profesional
        </button>
      </div>

    </div>
  </div>
</section>

  <section *ngSwitchCase="'trayectoria-profesional'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/empresario.png" alt="Trayectoria Profesional" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Trayectoria Profesional (Empleo)</h1>
        <p class="section-subtitle">Experiencia laboral y profesional</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('trayectoria-profesional') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Trayectoria Profesional</h2>

      <div class="row">
        
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Periodo y Vigencia</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="tray_prof_fecha_inicio">Fecha de Inicio *</label>
                <input type="date" id="tray_prof_fecha_inicio" formControlName="tray_prof_fecha_inicio" 
                       class="form-control input-custom"
                       [class.is-invalid]="isFieldInvalid('tray_prof_fecha_inicio')">
                <div class="invalid-feedback">La fecha de inicio es obligatoria.</div>
              </div>
              <div class="mb-3" *ngIf="!f['tray_prof_es_actual'].value">
                <label class="form-label small fw-bold" for="tray_prof_fecha_fin">Fecha de Término</label>
                <input type="date" id="tray_prof_fecha_fin" formControlName="tray_prof_fecha_fin" 
                       class="form-control input-custom">
                <div class="form-text muted-small">Dejar vacío si es su empleo actual.</div>
              </div>
              
              <div class="form-check form-switch mb-2">
                <input class="form-check-input custom-switch" type="checkbox" id="tray_prof_es_actual" 
                       formControlName="tray_prof_es_actual">
                <label class="form-check-label fw-bold text-borgona" for="tray_prof_es_actual">Es empleo actual</label>
              </div>
              
              <div *ngIf="f['tray_prof_es_actual'].value" class="alert alert-info small border-0 shadow-sm mb-2">
                <i class="fas fa-info-circle me-2"></i> Al ser empleo actual, no se requiere fecha de término.
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Documento Probatorio</div>
            <div class="card-body">
              <label class="form-label small" for="cert2">Constancia,Nombramiento,Contrato o Recibo de Nomina (PDF)</label>
              <input type="file" id="cert2" (change)="onFileChange($event, 'cert2')" 
                     class="form-control form-control-sm" accept=".pdf">
              <div *ngIf="f['cert2'].value" class="text-success small mt-1">
                <i class="fas fa-check-circle"></i> Archivo cargado correctamente
                <br><span class="text-muted small">En caso de ser un Recibo que no pase de 3 meses</span>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Detalles del Cargo</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="tray_prof_nombramiento">Puesto o Nombramiento *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/empresario.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="tray_prof_nombramiento" formControlName="tray_prof_nombramiento" 
                           class="form-control input-custom" 
                           [class.is-invalid]="isFieldInvalid('tray_prof_nombramiento')"
                           placeholder="Ej. Profesor o profesora investigador o investigadora titular C">
                    <div class="invalid-feedback">El puesto es obligatorio.</div>
                  </div>
                </div>

                <div class="col-md-12">
                  <label class="form-label fw-bold small">Institución / Empresa *</label>
                  <input type="text" formControlName="inst_nombre" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('inst_nombre')"
                         placeholder="Nombre de la institución o empresa">
                  <div class="invalid-feedback">La institución es obligatoria.</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Descripción de Logros</div>
            <div class="card-body">
              <textarea id="tray_prof_logros" formControlName="tray_prof_logros" 
                        class="form-control input-custom" rows="6" 
                        placeholder="Describe tus principales responsabilidades y logros obtenidos en este cargo..."></textarea>
              <div class="form-text muted-small mt-2">Máximo 2000 caracteres.</div>
            </div>
          </div>

          <div class="text-end">
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('cursos')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Cursos y Formación
        </button>
      </div>

    </div>
  </div>
</section>

  <section *ngSwitchCase="'cursos'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img [src]="getSectionIconImage('cursos')" alt="Cursos Impartidos" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Cursos Impartidos</h1>
        <p class="section-subtitle">Docencia y enseñanza</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('cursos') }}%</span>
      </div>
    </div>
  <div class="main-wrapper">
    <div class="content-container">

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Resumen de Carga</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/teacher_icon_243839.png" alt="Docencia" style="width: 64px;">
              </div>
              
              <div class="mb-3">
                <label class="form-label fw-bold small" for="curso_horas_totales">Horas Totales</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/reloj.png" style="width:16px;">
                  </span>
                  <input type="number" id="curso_horas_totales" formControlName="curso_horas_totales" 
                         class="form-control input-custom text-center" 
                         [class.is-invalid]="isFieldInvalid('curso_horas_totales')"
                         min="0"
                         placeholder="5">
                  <div class="invalid-feedback">No se permiten valores negativos. Mínimo: 0 horas</div>
                </div>
                <small class="form-text text-muted mt-1 d-block">Inicia en 5 horas (mínimo permitido: 0)</small>
              </div>

              <div class="form-check form-switch d-inline-block">
                <input class="form-check-input custom-switch" type="checkbox" id="curso_producto_principal" 
                       formControlName="art_producto_principal">
                <label class="form-check-label fw-bold text-borgona" for="curso_producto_principal">Producto Principal</label>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Periodo</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="curso_fecha_inicio">Fecha de Inicio *</label>
                <input type="date" id="curso_fecha_inicio" formControlName="curso_fecha_inicio" 
                       class="form-control input-custom"
                       [class.is-invalid]="isFieldInvalid('curso_fecha_inicio')">
                <div class="invalid-feedback">La fecha de inicio es requerida.</div>
              </div>
              <div class="mb-0">
                <label class="form-label small fw-bold" for="curso_fecha_fin">Fecha de Término</label>
                <input type="date" id="curso_fecha_fin" formControlName="curso_fecha_fin" 
                       class="form-control input-custom">
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Identificación del Curso</div>
            <div class="card-body row g-3">
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="curso_nombre">Nombre del Curso *</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/test_tasks_list_clipboard_todo_icon_191634.png" style="width:18px;height:18px;">
                  </span>
                  <input type="text" id="curso_nombre" formControlName="curso_nombre" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('curso_nombre')"
                         placeholder="Ej. Introducción a la Mecatrónica">
                  <div class="invalid-feedback">El nombre del curso es obligatorio.</div>
                </div>
              </div>

              <div class="col-md-12">
                <label class="form-label fw-bold small" for="curso_institucion">Institución donde se impartió *</label>
                <input type="text" id="curso_institucion" formControlName="curso_institucion" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('curso_institucion')"
                       placeholder="Nombre de la institución">
                <div class="invalid-feedback">La institución es obligatoria.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Programa y Nivel</div>
            <div class="card-body row g-3">
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="curso_programa">Nombre del Programa Académico *</label>
                <input type="text" id="curso_programa" formControlName="curso_programa" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('curso_programa')"
                       placeholder="Ej. Licenciatura en Ingeniería Civil">
                <div class="invalid-feedback">El nombre del programa es obligatorio.</div>
              </div>
              
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="curso_nivel_escolaridad">Nivel de Escolaridad del Curso *</label>
                <select id="curso_nivel_escolaridad" formControlName="curso_nivel_escolaridad" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('curso_nivel_escolaridad')">
                  <option value="">Selecciona nivel...</option>
                  <option value="Licenciatura">Licenciatura</option>
                  <option value="Maestría">Maestría</option>
                  <option value="Doctorado">Doctorado</option>
                  <option value="Técnico Superior">Técnico Superior</option>
                </select>
                <div class="invalid-feedback">Seleccione un nivel.</div>
              </div>
            </div>
          </div>

          <div class="alert alert-secondary d-flex align-items-center shadow-sm" role="alert" 
               style="background-color: #f8f4f5; border-left: 5px solid #800020;">
            <div class="small">
              <strong>Nota:</strong> Los comprobantes de docencia se gestionan de forma global en la sección de <strong>Documentos</strong> bajo la categoría "CURSOS".
            </div>
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('idiomas')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Idiomas
        </button>
      </div>

    </div>
  </div>
  </div>
</section>

<section *ngSwitchCase="'idiomas'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/language_translator_icon_150921.png" alt="Idiomas" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Idiomas</h1>
        <p class="section-subtitle">Dominio de idiomas</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('idiomas') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Dominio de Idiomas</h2>

      <div class="row">
        
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información General</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/language_translator_icon_150921.png" alt="Idioma" style="width: 64px;">
              </div>
              <div class="text-start">
                <label class="form-label fw-bold small" for="idioma_nombre">Idioma *</label>
                <div class="input-group mb-3">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/language_translator_icon_150921.png" style="width:16px;">
                  </span>
                  <input type="text" id="idioma_nombre" formControlName="idioma_nombre" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('idioma_nombre')"
                         placeholder="Ej. Inglés, Francés...">
                  <div class="invalid-feedback">Especifique el idioma.</div>
                </div>

                <label class="form-label fw-bold small" for="idioma_dominio_nombre">Dominio Global *</label>
                <select id="idioma_dominio_nombre" formControlName="idioma_dominio_nombre" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('idioma_dominio_nombre')">
                  <option value="">Selecciona nivel...</option>
                  <option value="Excelente">Excelente</option>
                  <option value="Avanzado">Avanzado</option>
                  <option value="Bueno">Bueno</option>
                  <option value="Regular">Regular</option>
                  <option value="Básico">Básico</option>
                </select>
                <div class="invalid-feedback">Seleccione un nivel de dominio.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm" *ngIf="mostrarCertificacion()">
            <div class="card-body">
              <div class="form-check form-switch">
                <input class="form-check-input custom-switch" type="checkbox" id="idioma_es_certificado" 
                       formControlName="idioma_es_certificado">
                <label class="form-check-label fw-bold text-borgona" for="idioma_es_certificado">¿Cuenta con certificación?</label>
              </div>
              <small class="text-muted">Active esta opción para registrar datos de la institución evaluadora.</small>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Niveles de Competencia</div>
            <div class="card-body">
              <div class="row g-3 text-center">
                <div class="col-md-4">
                  <label class="form-label small fw-bold" for="idioma_lectura">Lectura</label>
                  <select id="idioma_lectura" formControlName="idioma_lectura" class="form-select input-custom">
                    <option value="Básico">Básico</option>
                    <option value="Intermedio">Intermedio</option>
                    <option value="Avanzado">Avanzado</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label small fw-bold" for="idioma_escritura">Escritura</label>
                  <select id="idioma_escritura" formControlName="idioma_escritura" class="form-select input-custom">
                    <option value="Básico">Básico</option>
                    <option value="Intermedio">Intermedio</option>
                    <option value="Avanzado">Avanzado</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label small fw-bold" for="idioma_conversacion">Conversación</label>
                  <select id="idioma_conversacion" formControlName="idioma_conversacion" class="form-select input-custom">
                    <option value="Básico">Básico</option>
                    <option value="Intermedio">Intermedio</option>
                    <option value="Avanzado">Avanzado</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm" *ngIf="mostrarCertificacion() && f['idioma_es_certificado'].value">
            <div class="card-header bg-light text-borgona fw-bold">Detalles de la Evaluación</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="idioma_cert_institucion">Institución Evaluadora *</label>
                  <input type="text" id="idioma_cert_institucion" formControlName="idioma_cert_institucion" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('idioma_cert_institucion')"
                         placeholder="Ej. British Council, ETS, TOEFL">
                  <div class="invalid-feedback">Especifique la institución que certifica.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="idioma_cert_puntuacion">Puntuación / Score *</label>
                  <input type="text" id="idioma_cert_puntuacion" formControlName="idioma_cert_puntuacion" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('idioma_cert_puntuacion')"
                         placeholder="Ej. 100 pts, C1">
                  <div class="invalid-feedback">Ingrese el puntaje obtenido.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="idioma_vigencia_fin">Fin de Vigencia</label>
                  <input type="date" id="idioma_vigencia_fin" formControlName="idioma_vigencia_fin" 
                         class="form-control input-custom">
                </div>
                <div class="col-md-12">
                  <label class="form-label fw-bold small">Documento Probatorio (PDF)</label>
                  <input type="file" (change)="onFileChange($event, 'cert1')" 
                         class="form-control form-control-sm input-custom" accept=".pdf">
                  <div *ngIf="f['cert1'].value" class="text-success small mt-1">
                    <i class="fas fa-check-circle"></i> Certificado cargado
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="alert alert-info small border-0 shadow-sm" *ngIf="mostrarCertificacion() && !f['idioma_es_certificado'].value">
            <i class="fas fa-info-circle me-2"></i> Si tienes un certificado oficial, activa el interruptor para ingresar los detalles.
          </div>
          <div class="alert alert-warning small border-0 shadow-sm" *ngIf="!mostrarCertificacion()">
            <i class="fas fa-info-circle me-2"></i> Las certificaciones solo están disponibles para niveles de dominio Avanzado o Excelente.
          </div>

        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('estancias')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Estancias de Investigación
        </button>
      </div>

    </div>
  </div>
</section>

<section *ngSwitchCase="'estancias'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/calendario.png" alt="Estancias de Investigación" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Estancias de Investigación</h1>
        <p class="section-subtitle">Estancias académicas y de investigación</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('estancias') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Estancias de Investigación</h2>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Tipo de Estancia</div>
            <div class="card-body">
              <label class="form-label fw-bold small" for="estancia_tipo_nombre">Categoría *</label>
              <select id="estancia_tipo_nombre" formControlName="estancia_tipo_nombre" 
                      class="form-select input-custom"
                      [class.is-invalid]="isFieldInvalid('estancia_tipo_nombre')">
                <option value="">Selecciona tipo...</option>
                <option value="Posdoctoral">Posdoctoral</option>
                <option value="Sabatina">Sabatina</option>
                <option value="Investigador Invitado">Investigador Invitado</option>
                <option value="Estancia Corta">Estancia Corta</option>
              </select>
              <div class="invalid-feedback">Seleccione una categoría.</div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Periodo</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="estancia_fecha_inicio">Fecha de Inicio *</label>
                <input type="date" id="estancia_fecha_inicio" formControlName="estancia_fecha_inicio" 
                       class="form-control input-custom"
                       [class.is-invalid]="isFieldInvalid('estancia_fecha_inicio')">
                <div class="invalid-feedback">La fecha de inicio es requerida.</div>
              </div>
              <div class="mb-0">
                <label class="form-label small fw-bold">Fecha de Término</label>
                <input type="date" id="estancia_fecha_fin" formControlName="estancia_fecha_fin" class="form-control input-custom">
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Detalles de la Estancia</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label fw-bold small" for="estancia_nombre_proyecto">Nombre del Proyecto o Estancia *</label>
                <input type="text" id="estancia_nombre_proyecto" formControlName="estancia_nombre_proyecto" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('estancia_nombre_proyecto')"
                       placeholder="Nombre del proyecto...">
                <div class="invalid-feedback">El nombre del proyecto es obligatorio.</div>
              </div>
              <div class="mb-0">
                <label class="form-label fw-bold small" for="estancia_institucion_receptora">Institución Receptora *</label>
                <input type="text" id="estancia_institucion_receptora" formControlName="estancia_institucion_receptora" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('estancia_institucion_receptora')"
                       placeholder="¿Dónde realizó la estancia?">
                <div class="invalid-feedback">La institución receptora es obligatoria.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Logros y Resultados de la Estancia</div>
            <div class="card-body">
              <textarea id="estancia_logros" formControlName="estancia_logros" 
                        class="form-control input-custom" rows="6" 
                        placeholder="Describe los productos u objetivos alcanzados en esta estancia específica..."></textarea>
              <div class="form-text small mt-2">Esta información es independiente de su trayectoria profesional.</div>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5" (click)="setView('aportaciones')">
          Siguiente: Aportaciones (Artículos)
        </button>
      </div>

    </div>
  </div>
</section>



<section *ngSwitchCase="'aportaciones'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img [src]="getSectionIconImage('aportaciones')" alt="Aportaciones Científicas" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Aportaciones Científicas</h1>
        <p class="section-subtitle">Artículos y publicaciones</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('aportaciones') }}%</span>
      </div>
    </div>
  <div class="main-wrapper">
    <div class="content-container">

      <div class="row">
        <div class="col-lg-4 mb-4">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Identificadores y Métricas</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="art_doi">DOI (Digital Object Identifier)</label>
                <input type="text" id="art_doi" formControlName="art_doi" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('art_doi')"
                       placeholder="Ej. 10.1000/xyz123">
                <div class="invalid-feedback">Formato de DOI no válido.</div>
              </div>
              
              <div class="row g-2 mb-3">
                <div class="col-6">
                  <label class="form-label small fw-bold" for="art_issn">ISSN Impreso</label>
                  <input type="text" id="art_issn" formControlName="art_issn" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('art_issn')"
                         placeholder="0000-0000">
                </div>
                <div class="col-6">
                  <label class="form-label small fw-bold" for="art_issn_electronico">ISSN-e</label>
                  <input type="text" id="art_issn_electronico" formControlName="art_issn_electronico" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('art_issn_electronico')"
                         placeholder="0000-0000">
                </div>
                <div class="col-12" *ngIf="isFieldInvalid('art_issn') || isFieldInvalid('art_issn_electronico')">
                  <small class="text-danger small">Formato ISSN requerido: 0000-0000</small>
                </div>
              </div>

              <div class="mb-0">
                <label class="form-label small fw-bold" for="art_total_citas">Total de Citas</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/quote_5572.png" style="width:16px;">
                  </span>
                  <input type="number" id="art_total_citas" formControlName="art_total_citas" 
                         class="form-control input-custom text-center"
                         [class.is-invalid]="isFieldInvalid('art_total_citas')">
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Financiamiento</div>
            <div class="card-body">
              <div class="form-check form-switch mb-3">
                <input class="form-check-input custom-switch" type="checkbox" id="art_recibio_apoyo_SECIHTI" 
                       formControlName="art_recibio_apoyo_SECIHTI">
                <label class="form-check-label fw-bold text-borgona" for="art_recibio_apoyo_SECIHTI">¿Recibió apoyo SECIHTI?</label>
              </div>
              
              <div *ngIf="f['art_recibio_apoyo_SECIHTI'].value">
                <label class="form-label small fw-bold" for="art_fondo_prog_nombre">Fondo / Programa *</label>
                <input type="text" id="art_fondo_prog_nombre" formControlName="art_fondo_prog_nombre" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('art_fondo_prog_nombre')"
                       placeholder="Nombre del fondo o programa">
                <div class="invalid-feedback">Especifique el fondo.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Evidencia (Aprovación de articulo)</div>
            <div class="card-body text-center">
              <div class="mb-2">
                <img src="assets/img/documentos.png" alt="PDF" style="width: 40px; opacity: 0.7;">
              </div>
              <input type="file" (change)="onFileChange($event, 'cert1')" 
                     class="form-control form-control-sm" accept=".pdf">
              <div *ngIf="f['cert1'].value" class="text-success small mt-1">Archivo listo.</div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Información de la Publicación</div>
            <div class="card-body row g-3">
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="art_titulo">Título del Artículo *</label>
                <textarea id="art_titulo" formControlName="art_titulo" 
                          class="form-control input-custom" rows="3" 
                          [class.is-invalid]="isFieldInvalid('art_titulo')"
                          placeholder="Título completo de la investigación"></textarea>
                <div class="invalid-feedback">El título es obligatorio.</div>
              </div>

              <div class="col-md-12">
                <label class="form-label fw-bold small" for="art_nombre_revista">Revista Científica *</label>
                <input type="text" id="art_nombre_revista" formControlName="art_nombre_revista" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('art_nombre_revista')"
                       placeholder="Nombre de la revista editorial">
                <div class="invalid-feedback">El nombre de la revista es obligatorio.</div>
              </div>

              <div class="col-md-4">
                <label class="form-label fw-bold small" for="art_anio">Año de Publicación *</label>
                <input type="number" id="art_anio" formControlName="art_anio" 
                       class="form-control input-custom" 
                       [class.is-invalid]="isFieldInvalid('art_anio')"
                       [min]="1800"
                       [max]="9999"
                       placeholder="Ej: 2020">
                <div class="invalid-feedback">El año debe ser mayor o igual a 1800.</div>
              </div>

              <div class="col-md-4">
                <label class="form-label fw-bold small" for="art_estado_nombre">Estado de la Obra *</label>
                <select id="art_estado_nombre" formControlName="art_estado_nombre" class="form-select input-custom">
                  <option value="Publicado">Publicado</option>
                  <option value="Aceptado">Aceptado</option>
                  <option value="En prensa">En prensa</option>
                </select>
              </div>

              <div class="col-md-4">
                <label class="form-label fw-bold small" for="art_rol_part_nombre">Tu Rol en el Artículo *</label>
                <select id="art_rol_part_nombre" formControlName="art_rol_part_nombre" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('art_rol_part_nombre')">
                  <option value="">Selecciona rol...</option>
                  <option value="Autor Principal">Autor Principal</option>
                  <option value="Coautor">Coautor</option>
                  <option value="Autor de Correspondencia">Autor de Correspondencia</option>
                </select>
                <div class="invalid-feedback">Seleccione su rol.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Detalles del Autor Principal</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-2">
                  <label class="form-label small fw-bold">Orden</label>
                  <input type="number" id="art_autor_orden" formControlName="art_autor_orden" 
                         class="form-control input-custom text-center"
                         min="0"
                         placeholder="1">
                  <small class="form-text text-muted mt-1 d-block">Mínimo: 0</small>
                </div>
                <div class="col-md-6">
                  <label class="form-label small fw-bold" for="art_autor_nombre_completo">Nombre Completo del Autor *</label>
                  <input type="text" id="art_autor_nombre_completo" formControlName="art_autor_nombre_completo" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('art_autor_nombre_completo')"
                         placeholder="Nombres y Apellidos">
                  <div class="invalid-feedback">Nombre requerido.</div>
                </div>
                <div class="col-md-4">
                  <label class="form-label small fw-bold">ORCID del Autor</label>
                  <input type="text" id="art_autor_orcid" formControlName="art_autor_orcid" 
                         class="form-control input-custom" 
                         [class.is-invalid]="isFieldInvalid('art_autor_orcid')"
                         placeholder="0000-0000-0000-0000">
                </div>
              </div>
            </div>
          </div>

          <div class="text-end">
          </div>

        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('congresos')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Congresos y Eventos
        </button>
      </div>

    </div>
  </div>
  </div>
</section>

<section *ngSwitchCase="'congresos'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img [src]="getSectionIconImage('congresos')" alt="Congresos y Eventos" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Congresos y Eventos</h1>
        <p class="section-subtitle">Participación en eventos</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('congresos') }}%</span>
      </div>
    </div>
  <div class="main-wrapper">
    <div class="content-container">

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Fecha y Ubicación</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="congreso_fecha">Fecha del Evento *</label>
                <div class="input-group">
                  <span class="input-group-text bg-light border-borgona">
                    <img src="assets/img/month_appointment_event_schedule_full_date_calendar_icon_252110.png" style="width:16px;">
                  </span>
                  <input type="date" id="congreso_fecha" formControlName="congreso_fecha" 
                         class="form-control input-custom"
                         [class.is-invalid]="isFieldInvalid('congreso_fecha')">
                  <div class="invalid-feedback">La fecha es requerida.</div>
                </div>
              </div>
              <div class="mb-0">
                <label class="form-label small fw-bold" for="congreso_pais">País sede *</label>
                <select id="congreso_pais" formControlName="congreso_pais_sede" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('congreso_pais_sede')">
                  <option value="">Selecciona país...</option>
                  <option value="México">México</option>
                  <option value="España">España</option>
                  <option value="Estados Unidos">Estados Unidos</option>
                  <option value="Otro">Otro</option>
                </select>
                <div class="invalid-feedback">Seleccione el país sede.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-body text-center">
              <div class="form-check form-switch d-inline-block">
                <input class="form-check-input custom-switch" type="checkbox" id="congreso_principal" formControlName="art_producto_principal">
                <label class="form-check-label fw-bold text-borgona" for="congreso_principal">Producto Principal</label>
              </div>
              <p class="text-muted small mt-2">Marca esta opción si esta participación es relevante para tu evaluación.</p>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Datos del Evento</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="congreso_nombre_evento">Nombre del Congreso / Simposio *</label>
                  <div class="input-group">
                    <span class="input-group-text bg-light border-borgona">
                      <img src="assets/img/documentos.png" style="width:18px;height:18px;">
                    </span>
                    <input type="text" id="congreso_nombre_evento" formControlName="congreso_nombre_evento" 
                           class="form-control input-custom" 
                           [class.is-invalid]="isFieldInvalid('congreso_nombre_evento')"
                           placeholder="Ej. Congreso Internacional de IA">
                    <div class="invalid-feedback">El nombre del evento es obligatorio.</div>
                  </div>
                </div>

                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="congreso_tipo_part_nombre">Tipo de Participación *</label>
                  <select id="congreso_tipo_part_nombre" formControlName="congreso_tipo_part_nombre" 
                          class="form-select input-custom"
                          [class.is-invalid]="isFieldInvalid('congreso_tipo_part_nombre')">
                    <option value="">Selecciona...</option>
                    <option value="Ponente">Ponente</option>
                    <option value="Conferencista Magistral">Conferencista Magistral</option>
                    <option value="Presentación de Póster">Presentación de Póster</option>
                    <option value="Organizador">Organizador</option>
                  </select>
                  <div class="invalid-feedback">Seleccione su tipo de participación.</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Trabajo Presentado</div>
            <div class="card-body">
              <label class="form-label fw-bold small" for="congreso_titulo_trabajo">Título del Trabajo o Ponencia</label>
              <textarea id="congreso_titulo_trabajo" formControlName="congreso_titulo_trabajo" 
                        class="form-control input-custom" rows="4" 
                        placeholder="Nombre completo de la investigación presentada"></textarea>
            </div>
          </div>

          <div class="text-end">
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('divulgacion')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Divulgación
        </button>
      </div>

    </div>
  </div>
  </div>
</section>


<section *ngSwitchCase="'divulgacion'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/communicate_connection_propaganda_announce_news_icon_143344.png" alt="Divulgación Científica" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Divulgación Científica</h1>
        <p class="section-subtitle">Actividades de divulgación</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('divulgacion') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Actividades de Divulgación</h2>

      <div class="row">
        
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Clasificación</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/communicate_connection_propaganda_announce_news_icon_143344.png" alt="Divulgación" style="width: 64px;">
              </div>
              <div class="text-start">
                <label class="form-label fw-bold small" for="divulg_tipo_div_nombre">Tipo de Divulgación *</label>
                <select id="divulg_tipo_div_nombre" formControlName="divulg_tipo_div_nombre" 
                        class="form-select input-custom mb-3"
                        [class.is-invalid]="isFieldInvalid('divulg_tipo_div_nombre')">
                  <option value="">Selecciona...</option>
                  <option value="Científica">Científica</option>
                  <option value="Tecnológica">Tecnológica</option>
                  <option value="Humanista">Humanista</option>
                </select>
                <div class="invalid-feedback">Seleccione el tipo.</div>

                <label class="form-label fw-bold small" for="divulg_medio_nombre">Medio de Comunicación *</label>
                <select id="divulg_medio_nombre" formControlName="divulg_medio_nombre" 
                        class="form-select input-custom"
                        [class.is-invalid]="isFieldInvalid('divulg_medio_nombre')">
                  <option value="">Selecciona medio...</option>
                  <option value="Televisión">Televisión</option>
                  <option value="Radio">Radio</option>
                  <option value="Prensa Escrita">Prensa Escrita</option>
                  <option value="Redes Sociales">Redes Sociales</option>
                </select>
                <div class="invalid-feedback">Seleccione el medio.</div>
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Alcance y Fecha</div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label small fw-bold" for="divulg_dirigido_a">Público Dirigido</label>
                <select id="divulg_dirigido_a" formControlName="divulg_dirigido_a" class="form-select input-custom">
                  <option value="">Selecciona público...</option>
                  <option value="Público General">Público General</option>
                  <option value="Estudiantes">Estudiantes</option>
                  <option value="Especialistas">Especialistas</option>
                </select>
              </div>
              <div class="mb-0">
                <label class="form-label small fw-bold" for="divulg_fecha">Fecha de Realización *</label>
                <input type="date" id="divulg_fecha" formControlName="divulg_fecha" 
                       class="form-control input-custom"
                       [class.is-invalid]="isFieldInvalid('divulg_fecha')">
                <div class="invalid-feedback">La fecha es obligatoria.</div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Detalles de la Actividad</div>
            <div class="card-body row g-3">
              <div class="col-md-12">
                <label class="form-label fw-bold small" for="divulg_titulo">Título del Trabajo *</label>
                <textarea id="divulg_titulo" formControlName="divulg_titulo" 
                          class="form-control input-custom" rows="3" 
                          [class.is-invalid]="isFieldInvalid('divulg_titulo')"
                          placeholder="Nombre de la charla, artículo de blog, entrevista, etc."></textarea>
                <div class="invalid-feedback">El título de la actividad es obligatorio.</div>
              </div>

              <div class="col-md-12">
                <label class="form-label fw-bold small">Institución Organizadora / Medio</label>
                <input type="text" id="divulg_institucion_organizadora" formControlName="divulg_institucion_organizadora" class="form-control input-custom" 
                       placeholder="Nombre del organismo o medio de comunicación">
              </div>
            </div>
          </div>

          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Productos Obtenidos</div>
            <div class="card-body">
              <label class="form-label fw-bold small" for="divulg_prod_obtenido_nombre">Resultado Principal</label>
              <select id="divulg_prod_obtenido_nombre" formControlName="divulg_prod_obtenido_nombre" class="form-select input-custom">
                <option value="">Selecciona el producto principal...</option>
                <option value="Video / Grabación">Video / Grabación</option>
                <option value="Reseña Escrita">Reseña Escrita</option>
                <option value="Material Didáctico">Material Didáctico</option>
                <option value="Constancia de Participación">Constancia de Participación</option>
                <option value="Entrevista Publicada">Entrevista Publicada</option>
              </select>
              
              <!-- Campo de archivo que aparece cuando hay producto obtenido -->
              <div *ngIf="f['divulg_prod_obtenido_nombre'].value && f['divulg_prod_obtenido_nombre'].value !== ''" class="mt-3">
                <label class="form-label fw-bold small" for="divulg_archivo">Documento Probatorio (PDF, Imagen, Video) *</label>
                <input type="file" id="divulg_archivo" (change)="onFileChange($event, 'divulg_archivo')" 
                       class="form-control form-control-sm input-custom" 
                       accept=".pdf,.jpg,.jpeg,.png,.mp4,.mov,.avi">
                <div class="form-text small text-muted">Carga un archivo que corrobore el producto obtenido.</div>
                <div *ngIf="f['divulg_archivo'].value" class="text-success small mt-1">
                  <i class="fas fa-check-circle"></i> Archivo cargado: {{ f['divulg_archivo'].value?.name }}
                </div>
              </div>
            </div>
          </div>

          <div class="text-end">
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="setView('logros')">
          <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
          Siguiente: Logros
        </button>
      </div>

    </div>
  </div>
</section>



<section *ngSwitchCase="'logros'">
  <div class="section-container">
    <div class="section-header">
      <div class="section-header-icon">
        <img src="assets/img/4230509-achievement-trophy_114984.png" alt="Logros y Reconocimientos" style="width: 48px; height: 48px; object-fit: contain;">
      </div>
      <div>
        <h1 class="section-title">Logros y Reconocimientos</h1>
        <p class="section-subtitle">Premios y distinciones</p>
      </div>
      <div class="section-progress-badge">
        <span>{{ getSectionProgress('logros') }}%</span>
      </div>
    </div>
  </div>
  <div class="main-wrapper">
    <div class="content-container">
      <h2 class="text-borgona mb-4">Logros y Reconocimientos</h2>

      <div class="row">
        <div class="col-lg-4 mb-4">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Reconocimiento</div>
            <div class="card-body text-center">
              <div class="mb-3">
                <img src="assets/img/4230509-achievement-trophy_114984.png" alt="Logro" style="width: 64px;">
              </div>
              <div class="text-start">
                <label class="form-label fw-bold small" for="logro_tipo">Tipo de Organismo</label>
                <input type="text" id="logro_tipo" formControlName="logro_tipo" 
                       class="form-control input-custom" placeholder="Ej. SECIHTI">
              </div>
            </div>
          </div>

          <div class="card border-borgona shadow-sm">
            <div class="card-body py-2">
              <label class="form-label small text-muted mb-0">ID Perfil: </label>
              <span class="small fw-bold ms-1">{{ f['uuid_interno'].value }}</span>
            </div>
          </div>
        </div>

        <div class="col-lg-8">
          <div class="card border-borgona mb-3 shadow-sm">
            <div class="card-header bg-light text-borgona fw-bold">Detalles del Mérito</div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-12">
                  <label class="form-label fw-bold small" for="logro_nombre">Nombre del Logro *</label>
                  <input type="text" id="logro_nombre" formControlName="logro_nombre" 
                         class="form-control input-custom"
                         [class.is-invalid]="isFieldInvalid('logro_nombre')">
                  <div class="invalid-feedback">El nombre del logro es obligatorio.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-bold small" for="logro_anio">Año de Obtención *</label>
                  <input type="number" id="logro_anio" formControlName="logro_anio" 
                         class="form-control input-custom"
                         [class.is-invalid]="isFieldInvalid('logro_anio')"
                         min="0"
                         placeholder="AAAA">
                  <div class="invalid-feedback">Año inválido. No se permiten valores negativos.</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button type="button" class="btn btn-borgona px-5 d-flex align-items-center gap-2 justify-content-center mx-auto"
                (click)="submitFinal($event)" [disabled]="submitting()">
          <span *ngIf="!submitting()">
            <img src="assets/img/guardar.png" alt="" style="width:18px;height:18px;"> 
            COMPLETAR REGISTRO
          </span>
          <span *ngIf="submitting()">
            <i class="fas fa-spinner fa-spin"></i> PROCESANDO...
          </span>
        </button>
      </div>
    </div>
  </div>
</section>

      <!-- Sección de Migración SECIHTI al final -->
      <section *ngSwitchCase="'documentos'">
        <div class="section-container">
          <div class="section-header">
            <div class="section-header-icon">
              <img src="assets/img/documentos.png" alt="Migración SECIHTI" style="width: 48px; height: 48px; object-fit: contain;">
            </div>
            <div>
              <h1 class="section-title">Migración SECIHTI</h1>
              <p class="section-subtitle">Importa tus datos históricos del sistema anterior</p>
            </div>
            <div class="section-progress-badge">
              <span>Opcional</span>
            </div>
          </div>
        </div>
        <div class="welcome-section">
            <div class="info-cards mb-4">
              <div class="info-card">
                <div class="info-icon">
                  <img src="assets/img/documentos.png" alt="Migración" style="width: 48px; height: 48px; object-fit: contain;">
                </div>
                <h3 class="info-title">Migración de Datos Históricos</h3>
                <p class="info-text">
                  Si tienes datos previos del sistema anterior de SECIHTI, puedes importarlos automáticamente usando tu código de migración y archivo JSON.
                </p>
                <div class="info-details" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                  <p style="font-weight: 600; margin-bottom: 10px; color: #800020;">La migración incluye:</p>
                  <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin-bottom: 8px;"><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Trayectorias académicas y profesionales</li>
                    <li style="margin-bottom: 8px;"><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Producción científica y artículos</li>
                    <li style="margin-bottom: 8px;"><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Logros, becas y distinciones</li>
                    <li style="margin-bottom: 8px;"><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Idiomas registrados</li>
                    <li style="margin-bottom: 8px;"><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Estancias y congresos</li>
                    <li><i class="fas fa-check-circle" style="color: #28a745; margin-right: 8px;"></i>Divulgación científica</li>
                  </ul>
                </div>
                <div class="info-note" style="margin-top: 15px; padding: 12px; background-color: #f8f9fa; border-radius: 6px; border-left: 3px solid #800020;">
                  <p style="margin: 0; font-size: 14px;"><strong>¿Eres usuaria o usuario nuevo?</strong> Puedes omitir este paso y comenzar a llenar tu perfil desde cero.</p>
                </div>
              </div>
            </div>

            <form id="migracionForm" class="migration-form">
              <div class="row justify-content-center">
                <div class="col-lg-5 col-md-6 mb-4">
                  <div class="help-card">
                    <div class="help-icon">
                      <img src="assets/img/documentos.png" alt="Migración" style="width: 48px; height: 48px; object-fit: contain;">
                    </div>
                    <h3 class="help-title">¿Qué es la migración?</h3>
                    <p class="help-text">
                      Si tienes datos del sistema anterior de SECIHTI, puedes importarlos autométicamente usando tu código de migración y archivo JSON.
                    </p>
                    <div class="help-benefits">
                      <h4 class="benefits-title" style="font-size: 14px; font-weight: 600; margin-bottom: 12px; color: #800020;">La migración incluye:</h4>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Trayectorias académicas y profesionales:</strong> Grados, estudios, experiencia laboral</span>
                      </div>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Producción científica y artículos:</strong> Publicaciones, investigaciones y trabajos académicos</span>
                      </div>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Logros, becas y distinciones:</strong> Premios, reconocimientos y logros obtenidos</span>
                      </div>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Idiomas registrados:</strong> Dominio de idiomas y certificaciones</span>
                      </div>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Estancias y congresos:</strong> Participación en eventos académicos</span>
                      </div>
                      <div class="benefit-item">
                        <i class="fas fa-check-circle" style="color: #28a745;"></i>
                        <span><strong>Divulgación científica:</strong> Actividades de divulgación y comunicación</span>
                      </div>
                    </div>
                    <div class="help-note">
                      <i class="fas fa-info-circle"></i>
                      <p><strong>¿Eres usuaria o usuario nuevo?</strong> Puedes omitir este paso y comenzar a llenar tu perfil desde cero.</p>
                    </div>
                  </div>
                </div>

                <div class="col-lg-7 col-md-6">
                  <div class="migration-card">
                    <div class="migration-header">
                      <h3 class="migration-title">Vinculación de Datos Históricos</h3>
                      <p class="migration-subtitle">Ingresa tus datos de migración para importar tu información</p>
                    </div>
                    <div class="migration-body">
                      <div class="form-group-custom">
                      </div>

                      <div class="form-group-custom">
                        <label class="form-label-custom" for="migracion_json">
                          <i class="fas fa-file-code"></i>
                          Archivo JSON para Migración *
                        </label>
                        <div class="file-upload-area" 
                             [class.drag-over]="isDraggingJson"
                             (click)="triggerFileInput()"
                             (dragover)="onDragOverJson($event)"
                             (dragleave)="onDragLeaveJson($event)"
                             (drop)="onDropJson($event)">
                          <input type="file" id="migracion_json" name="migracion_json"
                            class="file-input" accept=".json"
                            (change)="onFileSelectedJson($event)">
                          <div class="file-upload-content" *ngIf="!jsonFileName">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Haz clic para seleccionar o arrastra tu archivo JSON aquí</p>
                            <small>Formato: .json</small>
                          </div>
                          <div class="file-selected-content" *ngIf="jsonFileName">
                            <i class="fas fa-file-code text-success"></i>
                            <p class="mb-1"><strong>{{ jsonFileName }}</strong></p>
                            <button type="button" class="btn btn-sm btn-outline-danger mt-2" 
                                    (click)="clearJsonFile($event)">
                              <i class="fas fa-times"></i> Eliminar archivo
                            </button>
                          </div>
                        </div>
                        <small class="form-help">Selecciona el archivo JSON que recibiste del sistema anterior</small>
                      </div>

                      <div class="form-check-custom">
                        <input class="form-check-input-custom" type="checkbox" id="acepto_politicas" 
                          name="acepto_politicas" required>
                        <label class="form-check-label-custom" for="acepto_politicas">
                          Acepto las políticas de tratamiento de datos personales
                        </label>
                      </div>

                      <div class="alert-custom">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                          <strong>Importante:</strong> Una vez iniciada la vinculación, los datos se cargarón permanentemente en tu perfil actual.
                        </div>
                      </div>

                      <div class="migration-actions">
                        <button type="button" class="btn-primary-custom" (click)="procesarMigracion()">
                          <i class="fas fa-upload"></i>
                          Iniciar Vinculación de Datos
                        </button>
                        <button type="button" class="btn-secondary-custom" (click)="setView('personaPrincipal')">
                          <i class="fas fa-arrow-right"></i>
                          Continuar sin Migración
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
      </section>

    </ng-container>
  </main>
</div>
